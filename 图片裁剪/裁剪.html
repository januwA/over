<!DOCTYPE html>
<html>
<head>
	<title>jquery jcrop剪裁图片</title>
	<meta charset="utf-8">
	<link rel="stylesheet" href="./Jcrop-0.9.12/css/jquery.Jcrop.css">
	<style type="text/css">


.jcrop-holder #preview-pane {
  position: absolute;
  top: 10px;
  right: -280px;

}

#preview-pane .preview-container {
  width: 250px;
  height: 170px;
  overflow: hidden;
}

</style>
</head>
<body>
<div class="span12">
<div class="jc-demo-box">
	<img src="./img/1.jpg" id="target" alt="[Jcrop Example]" width="300" />
	<div id="preview-pane">
    	<div class="preview-container">
     	 <img src="" class="jcrop-preview" alt="Preview" id="a"/>
   	 	</div>
 	 </div>

</div>
</div>


<script src="./Jcrop-0.9.12/js/jquery.min.js"></script>
<script src="./Jcrop-0.9.12/js/jquery.Jcrop.js""></script>
<script type="text/javascript">
  $(function($){

    let a = $('#a')
    let ti = $('#target')
    var jcrop_api,
        boundx,
        boundy,

        $preview = $('#preview-pane'),
        $pcnt = $('#preview-pane .preview-container'),
        $pimg = $('#preview-pane .preview-container img'),

        xsize = $pcnt.width(),
        ysize = $pcnt.height();
    
    $('#target').Jcrop({
      onChange: updatePreview,
      onSelect: updatePreview,
      aspectRatio: xsize / ysize,
      onDblClick: function() {

      	console.log( ti.attr('src') )
      	a.attr('src', ti.attr('src') )
      	console.log('实际尺寸 '+ JSON.stringify( this.tellSelect()) )
      	console.log('界面尺寸 '+ JSON.stringify( this.tellScaled()) )
      }
    },function(){
   	  this.animateTo([100,100,400,300]); // 页面加载自动弹出 截图框
      var bounds = this.getBounds();
      boundx = bounds[0];
      boundy = bounds[1];
      jcrop_api = this;
      $preview.appendTo(jcrop_api.ui.holder);
    });

    function updatePreview(c)
    {
      a.attr('src', ti.attr('src') )
      if (parseInt(c.w) > 0)
      {
        var rx = xsize / c.w;
        var ry = ysize / c.h;

        $pimg.css({
          width: Math.round(rx * boundx) + 'px',
          height: Math.round(ry * boundy) + 'px',
          marginLeft: '-' + Math.round(rx * c.x) + 'px',
          marginTop: '-' + Math.round(ry * c.y) + 'px'
        });
      }
    };

  });


</script>
</body>
</html>